{"title":"hw2","markdown":{"yaml":{"title":"hw2","editor":"visual"},"headingText":"Question 2a","containsRefs":false,"markdown":"\n```{r, message=F, echo = F, warning=F}\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(ggrepel)\nlibrary(ggcorrplot)\nlibrary(hrbrthemes)\n```\n\n\n\n\n\n```{r, message=F, warning = F, echo = F}\nhdi_corruption <- read_csv(\n  'https://bcdanl.github.io/data/hdi_corruption.csv')\nnms <- c('Argentina','China','Egypt','Greece','United States','Germany','Norway','Singapore',\n         'South Africa','Senegal')\nggplot(filter(hdi_corruption, year == 2014), mapping = aes(x = cpi, y = hdi)) +\n  geom_point(aes(color = region), alpha = 0.5, size = 2) +\n  geom_smooth(method = \"glm\", \n              method.args = list(family = \"binomial\"), \n              se = FALSE) +\n  geom_text_repel(data = filter(hdi_corruption, country %in% nms, year == 2014), \n                  aes(x = cpi, y = hdi, label = country),\n                  min.segment.length = unit(0, 'lines'),\n                  nudge_y = .02) +\n  theme_ipsum() +\n  theme(legend.position = \"top\") +\n  ylab('Human Development Index, 2014\\n (1.0 = Most Developed') +\n  xlab('Corruption Perceptions Index, 2014 (100 = Least Corrupt)')\n\n```\n\n## Question 2b\n\n\n```{r, echo = F, warning=F, message=F}\ndat <- read.csv('labor_supply.csv')\ndat1 <- mutate(dat, \n              u5 = if_else(NCHLT5 > 0, 1, 0),\n              lab = if_else(LABFORCE == 2, 1, 0),\n              SEX = if_else(SEX == 1, 'Male','Female'))\n\nname <- list(\n  '0'=\"No Child Under Age 5 in Household\",\n  '1'=\"At Least One Child Under Age 5 in Household\")\n\nlabeller <- function(variable,value){\n  return(name[value])\n}\n\ndat2 <- dat1 %>% \n  group_by(YEAR, SEX, u5) %>% \n  summarise(n = n(), lab = sum(lab))\nggplot(dat2, mapping = aes(x = YEAR, y = lab/n)) +\n  geom_line(aes(color = SEX), size = 2) +\n  geom_label_repel(data = filter(dat2, YEAR == 2022), \n                   mapping = aes(x = YEAR,\n                                 y = lab/n, \n                                 label = SEX),\n                   nudge_x = .2, nudge_y = .1) +\n  scale_x_continuous(breaks = seq(1982, 2022, by = 4), labels = seq(1982, 2022, by = 4)) +\n  facet_wrap(~factor(u5),\n             labeller = labeller) + \n  guides(color = 'none') +\n  theme_ipsum() +\n  theme(axis.text.x = element_text(angle = 45)) +\n  labs(title = 'Fertillity and Labor Supply in the U.S.',\n       subtitle = '1982-2022') +\n  ylab('Labor Force Participation Rate')\n```\n\n```{r, echo = F, warning = F, message = F}\nlibrary(ggcorrplot) # to create correlation heatmaps using ggcorrplot()\n\nbeer_mkt <- read_csv('https://bcdanl.github.io/data/beer_markets.csv')\n\nbeer_mkt1 <- beer_mkt %>% \n  select(brand:buyertype, children6to17, age, employment) %>% \n  mutate(NRB = if_else( container == 'NON REFILLABLE BOTTLE', 1, 0),\n         NaturalLight = if_else( brand == 'NATURAL LIGHT', 1, 0),\n         BudLight = if_else( brand == 'BUD LIGHT', 1, 0),\n         BuschLight = if_else( brand == 'BUSCH LIGHT', 1, 0),\n         CoorsLight = if_else( brand == 'COORS LIGHT', 1, 0),\n         MillerLite = if_else( brand == 'MILLER LITE', 1, 0),\n         buyertypemarried = if_else( buyertype == 'married', 1, 0),\n         employmentnone = if_else( employment == 'none', 1, 0),\n         age50 = if_else( age == '50+', 1, 0),\n         promotrue = if_else( promo == 'TRUE', 1, 0),\n         children6to17true = if_else( children6to17 == 'TRUE', 1, 0)) %>% \n  select(is.numeric)\n\n\ncorr <- round(cor(beer_mkt1), 2)\n\n\nggcorrplot(corr, lab = T)\n\n\nbeer_mkt2 <- beer_mkt %>% \n  filter(market %in% c('ALBANY', 'BUFFALO-ROCHESTER', 'URBAN NY', 'SUBURBAN NY', 'EXURBAN NY', 'RURAL NEW YORK', 'SYRACUSE')) %>% \n   select(brand:buyertype, children6to17, age, employment) %>% \n  mutate(NRB = if_else( container == 'NON REFILLABLE BOTTLE', 1, 0),\n         NaturalLight = if_else( brand == 'NATURAL LIGHT', 1, 0),\n         BudLight = if_else( brand == 'BUD LIGHT', 1, 0),\n         BuschLight = if_else( brand == 'BUSCH LIGHT', 1, 0),\n         CoorsLight = if_else( brand == 'COORS LIGHT', 1, 0),\n         MillerLite = if_else( brand == 'MILLER LITE', 1, 0),\n         buyertypemarried = if_else( buyertype == 'married', 1, 0),\n         employmentnone = if_else( employment == 'none', 1, 0),\n         age50 = if_else( age == '50+', 1, 0),\n         promotrue = if_else( promo == 'TRUE', 1, 0),\n         children6to17true = if_else( children6to17 == 'TRUE', 1, 0)) %>% \n  select(is.numeric)\n\ncorr <- round(cor(beer_mkt2), 2)\n\n\nggcorrplot(corr, lab = T)\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-after-body":["target_blank.html"],"output-file":"hw2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","theme":{"light":"flatly","dark":["darkly","theme-dark.scss"]},"title":"hw2","editor":"visual"},"extensions":{"book":{"multiFile":true}}}}}